TODO
Change BN to LN
Change it to conditional version